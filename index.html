<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoTrend</title>
    <link rel="stylesheet" href="src/styles/style.css" />
    <link rel="shortcut icon" href="src/imgs/favicon.png" type="image/x-icon" />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <header class="header">
      <div class="container">
        <a href="#" class="logo"> <i class="bx bxs-leaf"></i> EcoTrend </a>
        <nav class="navbar">
          <a href="#home">Início</a>
          <a href="#categories">Categorias</a>
          <a href="#products">Produtos</a>
          <a href="#about">Sobre</a>
        </nav>
        <div class="header-icons">
          <i id="carrinho" class="bx bx-cart"></i>
        </div>
      </div>
    </header>

    <main>
      <section class="hero" id="home">
        <div class="container">
          <div class="hero-text">
            <span>Moda que cuida do futuro</span>
            <h1>Vista-se de mudança com a nossa nova coleção</h1>
            <p>
              Peças com design atemporal, feitas com materiais de baixo impacto
              e produção ética.
            </p>
            <a href="src/pages/produtos.html" class="btn">Comprar Agora</a>
          </div>
        </div>
      </section>
      <section class="categories" id="categories">
        <div class="container">
          <h2 class="section-title">Nossas Categorias</h2>
          <div class="category-grid">
            <div class="category-card">
              <img src="src/imgs/mulher.jpg" alt="Roupas Femininas" />
              <h3>Roupas Femininas</h3>
            </div>
            <div class="category-card">
              <img src="src/imgs/homem.jpg" alt="Roupas Masculinas" />
              <h3>Roupas Masculinas</h3>
            </div>
            <div class="category-card">
              <img src="src/imgs/homem2.jpg" alt="Acessórios" />
              <h3>Acessórios</h3>
            </div>
          </div>
        </div>
      </section>

      <section class="products" id="products">
        <div class="container">
          <h2 class="section-title">Produtos em Destaque</h2>
          <div class="product-grid">
            <div class="product-card">
              <div class="product-image">
                <img src="src/imgs/camisa.png" alt="Produto 1" />
                <div class="product-icons">
                  <i class="bx bx-cart-add"></i>
                  <i class="bx bx-heart"></i>
                </div>
              </div>
              <div class="product-info">
                <span class="category-name">Algodão Orgânico</span>
                <h3>Camisa Branca Essencial</h3>
                <div class="product-price">R$ 189,90</div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="src/imgs/vestido.png" alt="Produto 2" />
                <div class="product-icons">
                  <i class="bx bx-cart-add"></i>
                  <i class="bx bx-heart"></i>
                </div>
              </div>
              <div class="product-info">
                <span class="category-name">Linho Misto</span>
                <h3>Vestido Midi</h3>
                <div class="product-price">R$ 329,90</div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="src/imgs/calca.png" alt="Produto 3" />
                <div class="product-icons">
                  <i class="bx bx-cart-add"></i>
                  <i class="bx bx-heart"></i>
                </div>
              </div>
              <div class="product-info">
                <span class="category-name">Tencel</span>
                <h3>Calça Pantalona Verde</h3>
                <div class="product-price">R$ 299,90</div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="src/imgs/bolsa.png" alt="Produto 4" />
                <div class="product-icons">
                  <i class="bx bx-cart-add"></i>
                  <i class="bx bx-heart"></i>
                </div>
              </div>
              <div class="product-info">
                <span class="category-name">Juta</span>
                <h3>Bolsa de Ombro Artesanal</h3>
                <div class="product-price">R$ 149,90</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="about-banner" id="about">
        <div class="container">
          <div class="about-text">
            <h2>Design consciente, do início ao fim.</h2>
            <p>
              Acreditamos que a moda pode ser uma força para o bem. Por isso,
              escolhemos materiais sustentáveis, valorizamos a produção local e
              criamos peças feitas para durar, não para serem descartadas.
            </p>
            <a
              href="src/pages/produtos.html"
              class="btn"
              style="font-weight: bold"
              >Ver Coleção Completa</a
            >
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-col">
            <a href="#" class="logo"> <i class="bx bxs-leaf"></i> EcoTrend </a>
            <p>
              Moda sustentável que inspira um futuro mais verde e consciente.
            </p>
          </div>
          <div class="footer-col">
            <h3>Links Rápidos</h3>
            <ul>
              <li><a href="#home">Início</a></li>
              <li><a href="#categories">Categorias</a></li>
              <li><a href="#products">Produtos</a></li>
              <li><a href="#about">Sobre</a></li>
            </ul>
          </div>
          <div class="footer-col">
            <h3>Contato</h3>
            <ul>
              <li><i class="bx bxs-map"></i> São Paulo, SP</li>
              <li><i class="bx bxs-phone"></i> (11) 99999-8888</li>
              <li><i class="bx bxs-envelope"></i> contato@ecotrend.com</li>
            </ul>
          </div>
          <div class="footer-col">
            <h3>Newsletter</h3>
            <p>Receba nossas novidades e promoções.</p>
            <form class="newsletter-form">
              <input type="email" placeholder="Seu e-mail" />
              <button type="submit" class="btn">
                <i class="bx bxs-paper-plane"></i>
              </button>
            </form>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 EcoTrend. Todos os direitos reservados.</p>
      </div>
    </footer>
    <div id="cartSidebar">
      <h2>Meu Carrinho</h2>
      <div id="cartItems"></div>
      <hr />
      <div class="cart-total">Total: R$ <span id="cartTotal">0.00</span></div>
      <button
        style="background-color: rgb(0, 173, 9)"
        onmouseover="this.style.backgroundColor='green'"
        onmouseout="this.style.backgroundColor='rgb(0, 173, 9)'"
        class="close-btn"
      >
        Finalizar Compra
      </button>
      <button onclick="closeCart()" class="close-btn">Fechar</button>
    </div>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const API = "/api/produtos"; // se sua página NÃO for servida pelo mesmo host/porta do Node, use: 'http://localhost:3000/api/produtos'
      const grid = document.querySelector(".products .product-grid");

      async function carregarProdutos() {
        const res = await fetch(API);
        if (!res.ok) {
          const txt = await res.text();
          throw new Error(`HTTP ${res.status} → ${txt.slice(0, 120)}...`);
        }
        return res.json(); // esperado: [{ id, nome, preco, material?, categoria?, imagem? }]
      }

      function criarCard(p) {
        const nome = p.nome ?? "Produto";
        const preco = Number(p.preco ?? 0);
        const material = p.material ?? "";
        const categoria = p.categoria ?? "";
        const imagem = p.imagem ?? "src/imgs/bolsa.png"; // ajuste para um placeholder existente

        const card = document.createElement("div");
        card.className = "product-card";
        if (categoria) card.dataset.category = categoria;
        if (material) card.dataset.material = material;

        card.innerHTML = `
          <div class="product-image">
            <img ..="${imagem}" alt="${nome}">
            <div class="product-icons">
              <i class='bx bx-cart-add'></i>
              <i class='bx bx-heart'></i>
            </div>
          </div>
          <div class="product-info">
            <span class="category-name">${material || categoria || "Eco"}</span>
            <h3>${nome}</h3>
            <div class="product-price">R$ ${preco
              .toFixed(2)
              .replace(".", ",")}</div>
          </div>
        `;
        return card;
      }

      try {
        const produtos = await carregarProdutos();

        // Se quiser substituir os cards estáticos pelos da API:
        // (se preferir manter os estáticos, remova a linha abaixo)
        grid.innerHTML = "";

        produtos.forEach((p) => grid.appendChild(criarCard(p)));
        console.log("Produtos renderizados:", produtos);
      } catch (err) {
        console.error("Erro ao carregar produtos:", err);
      }
    });
  </script>

  <script src="src/js/script.js"></script>
  <script src="src/js/server.js"></script>
  <script src="src/js/cart.js"></script>
</html>
